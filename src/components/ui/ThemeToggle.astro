---

---

<button
  class="theme-toggle"
  title="Theme: Light. Click to switch to Dark"
  aria-label="Theme: Light. Click to switch to Dark"
  data-theme="light"
  data-pagefind-ignore="all"
>
  <div class="theme-dots">
    <div class="theme-icon dot dot-1"></div>
    <div class="theme-icon dot dot-2"></div>
    <div class="theme-icon dot dot-3"></div>
  </div>
</button>

<script is:inline>
  function updateToggleState(toggle, theme) {
    const labels = { light: 'Light', dark: 'Dark', reading: 'Reading' }
    const nextTheme = { light: 'Dark', dark: 'Reading', reading: 'Light' }
    const text = 'Theme: ' + labels[theme] + '. Click to switch to ' + nextTheme[theme]

    toggle.setAttribute('data-theme', theme)
    toggle.setAttribute('title', text)
    toggle.setAttribute('aria-label', text)
  }

  function updateAllToggles(theme) {
    document.querySelectorAll('.theme-toggle').forEach(function(toggle) {
      updateToggleState(toggle, theme)
    })
  }

  if (!window._themeToggleListenerBound) {
    window._themeToggleListenerBound = true
    document.addEventListener('themechange', function(e) {
      updateAllToggles(e.detail.theme)
    })
  }

  function bindThemeToggles() {
    const themeToggles = document.querySelectorAll('.theme-toggle')
    if (!themeToggles.length || !window.ThemeManager) return

    var currentTheme = window.ThemeManager.getEffectiveTheme()

    themeToggles.forEach(function(toggle) {
      if (toggle.dataset.bound === 'true') return
      toggle.dataset.bound = 'true'

      updateToggleState(toggle, currentTheme)

      toggle.addEventListener('click', function(e) {
        e.preventDefault()
        e.stopPropagation()
        window.ThemeManager.toggle()
      })
    })
  }

  window.addEventListener('DOMContentLoaded', bindThemeToggles)

  document.addEventListener('astro:page-load', bindThemeToggles)
</script>

<style>
  .theme-toggle {
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    height: 1.5rem;
    gap: 0.1875rem;
    color: var(--text-primary);
    transition: opacity 0.2s ease;
    padding: 0.5rem;
    position: relative;
  }

  .theme-toggle:hover {
    opacity: 0.7;
  }

  /* Focus styles for keyboard navigation */
  .theme-toggle:focus-visible {
    outline: 2px solid var(--focus);
    outline-offset: 2px;
    border-radius: 0.25rem;
  }

  /* Dots container */
  .theme-dots {
    display: flex;
    gap: 0.1875rem;
  }

  /* Default: all hollow */
  .theme-icon.dot {
    width: 0.4375rem;
    height: 0.4375rem;
    border-radius: 50%;
    background-color: transparent;
    box-shadow: inset 0 0 0 1.125px var(--text-primary);
    transition: all 0.2s ease;
  }

  /* Light: dot-1 solid */
  .theme-toggle[data-theme='light'] .dot-1 {
    background-color: var(--text-primary);
    box-shadow: none;
  }

  /* Dark: dot-2 solid */
  .theme-toggle[data-theme='dark'] .dot-2 {
    background-color: var(--text-primary);
    box-shadow: none;
  }

  /* Reading: dot-3 solid */
  .theme-toggle[data-theme='reading'] .dot-3 {
    background-color: var(--text-primary);
    box-shadow: none;
  }

  @media (prefers-reduced-motion: reduce) {
    .theme-toggle {
      transition: none;
    }

    .theme-icon.dot {
      transition: none;
    }
  }
</style>
